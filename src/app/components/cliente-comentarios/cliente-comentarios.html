<div id="Container" class="justify-between flex w-full">
    <div class="mr-3 p-6 border rounded-lg bg-white shadow-sm w-full">
        <div class="flex justify-between">
            <h5 class="mb-2 text-2xl font-bold tracking-tight text-black dark:text-black">Tus Comentarios</h5>
            <button
                class="bg-primary-500 text-white border-0 justify-self-end px-2 mb-2 rounded-lg text-sm font-sans cursor-pointer flex items-center gap-2 transition-all duration-200 hover:bg-primary-600 hover:-translate-y-0.5"
                (click)="showDialog()">
                <i class="pi pi-plus"></i>
                Nuevo Comentario
            </button>
            <p-dialog header="Nuevo Comentario" [(visible)]="visible"
                [style]="{ width: '35rem', background: 'white', color: 'black' }" [modal]="true" [closable]="false"
                [dismissableMask]="false" [blockScroll]="true" (onHide)="onDialogHide()">
                
                <!-- Campo de comentario más grande -->
                <div class="flex flex-col gap-2 mb-4">
                    <label for="comentario" class="font-semibold text-black">Comentario</label>
                    <textarea 
                        id="comentario" 
                        rows="4" 
                        class="w-full p-3 border border-gray-300 rounded-lg bg-white text-black resize-none"
                        placeholder="Escribe tu comentario aquí..."
                        [(ngModel)]="newComentario.texto">
                    </textarea>
                </div>
                
                <!-- Sistema de estrellas para calificación -->
                <div class="flex flex-col gap-2 mb-4">
                    <label class="font-semibold text-black">Calificación</label>
                    <div class="flex gap-1">
                        <i 
                            *ngFor="let star of [1,2,3,4,5]; let i = index"
                            class="pi cursor-pointer text-xl transition-colors duration-200"
                            [class.pi-star-fill]="(i + 1) <= newComentario.calificacion"
                            [class.pi-star]="(i + 1) > newComentario.calificacion"
                            [class.text-yellow-500]="(i + 1) <= newComentario.calificacion"
                            [class.text-gray-300]="(i + 1) > newComentario.calificacion"
                            [class.hover:text-yellow-400]="true"
                            (click)="setCalificacion(i + 1)"
                            (mouseenter)="hoverCalificacion = i + 1"
                            (mouseleave)="hoverCalificacion = 0">
                        </i>
                    </div>
                    <span class="text-sm text-gray-600">
                        {{ newComentario.calificacion > 0 ? newComentario.calificacion + ' de 5 estrellas' : 'Selecciona una calificación' }}
                    </span>
                </div>
                
                <div class="flex justify-end gap-2">
                    <p-button label="Cancelar" severity="secondary" (click)="hideDialog()" />
                    <p-button label="Guardar" (click)="postComentario()" [disabled]="!newComentario.texto || newComentario.calificacion === 0" />
                </div>
            </p-dialog>
        </div>
        <div *ngIf="comentarios.length === 0">
            <p>No hay comentarios disponibles.</p>
        </div>
        <div *ngFor="let com of usercomentarios" class=" p-6 border w-full rounded-lg bg-white shadow-sm mb-3">
            <p class="text-sm text-gray-500">Fecha: {{ com.fechaHora }}</p>
            <p class="text-sm text-black">{{ com.texto }}</p>
            <div class="flex">
                <i class="pi pi-star-fill flex ">
                    <p class="text-gray-700 ml-2">{{ com.calificacion }}</p>
                </i>
            </div>
        </div>
    </div>
    <div class="mr-3 p-6 border rounded-lg bg-white shadow-sm w-full">
        <div>
            <h5 class="mb-2 text-2xl font-bold tracking-tight text-black dark:text-black">Comentarios</h5>
        </div>
        <div *ngIf="comentarios.length === 0">
            <p>No hay comentarios disponibles.</p>
        </div>
        <div *ngFor="let com of comentarios" class=" p-6 border w-full rounded-lg bg-white shadow-sm mb-3">
            <p class="text-sm text-gray-500">Fecha: {{ com.fechaHora }}</p>
            <p class="text-sm text-black">{{ com.texto }}</p>
            <div class="flex">
                <i class="pi pi-star-fill flex ">
                    <p class="text-gray-700 ml-2">{{ com.calificacion }}</p>
                </i>
            </div>
        </div>
    </div>
</div>